<!doctype html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>Continuuity</title>
  <meta name="description" content="">
  <meta name="author" content="Continuuity, Inc.">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">

  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="../assets/css/main.css">

  <link rel="stylesheet" href="./patch/assets/main.css">

  <script type="text/javascript" src="/core/lib/jquery.min.js"></script>
  <script type="text/javascript" src="/core/lib/bootstrap.min.js"></script>
  <script type="text/javascript" src="/core/lib/handlebars-1.0.0.beta.6.js"></script>
  <script type="text/javascript" src="/core/lib/ember-1.0.pre.js"></script>
  <script type="text/javascript" src="/socket.io/socket.io.js"></script>
  <script type="text/javascript" src="/core/lib/jquery.timeago.js"></script>
  <script type="text/javascript" src="/core/lib/jquery.jsPlumb-1.3.6-all.js"></script>
  <script type="text/javascript" src="/core/lib/d3.v2.min.js"></script>
  <script data-main="main" src="../core/lib/require.js"></script>

</head>
<body>
 <div id="nav">
    <a href="#" id="logo"></a>
    <ul>
      <li><a class="nav-link nav-dash" href="#">Dashboard</a></li>
      <li><a class="nav-link nav-apps" href="#/apps">Applications</a></li>
      <li><a class="nav-link nav-streams" href="#/streams">Streams</a></li>
      <li><a class="nav-link nav-flows" href="#/flows">Flows</a></li>
      <li><a class="nav-link nav-datasets" href="#/data">Datasets</a></li>
      <li><a class="nav-link nav-queries" href="#/queries">Queries</a></li>
    </ul>
  </div>

  <script type="text/x-handlebars" data-template-name="main">
    <div id="header">
      <div id="global">
        <a class="global-link global-user" href="#">{{user.name}}</a>
      </div>
      <ul id="breadcrumb">
      {{#each breadcrumbs}}
        <li><a {{bindAttr href="href"}}>{{name}}</a></li>
      {{/each}}
      </ul>
    </div>
    <div id="warning"><div>Experiencing latency issues. Please contact <a href="mailto:ops@continuuity.com">ops@continuuity.com</a></div></div>
    <div id="interstitial"></div>
    <div id="content-body">
      {{outlet}}
    </div>
    <div id="footer" style="clear: both;">COPYRIGHT &copy; 2012 CONTINUUITY INC. ALL RIGHTS RESERVED.<br />
    <i class="icon-question-sign"></i><a style="text-decoration: underline;" href="mailto:support@continuuity.com">
    Send us Questions &amp; Feedback</a> &#183; <a style="text-decoration:underline;" href="#" onclick="return C.util.reset();">Reset AppFabric</a></div>
  </script>

  <script type="text/x-handlebars" data-template-name="dashboard">
    <div id="title">
      {{view C.Vw.TimeSelector}}
      <h1>Dashboard</h1>
    </div>
    <div id="panels">
      <div class="panel">
        <div class="panel-head"><div class="panel-title">Account Summary</div></div>
        <table class="dash-app-resources">
          <tbody>
            <tr>
              <td class="dash-app-resource dash-app-resource-health"></td>
              <td class="dash-app-resource">
                <a href="#/apps" class="dash-app-resource-app">{{controller.counts.Application}}</a>
              </td>
              <td class="dash-app-resource">
                <a href="#/flows" class="dash-app-resource-flow">{{controller.counts.Flow}}</a>
              </td>
              <td class="dash-app-resource">
                <a href="#/streams" class="dash-app-resource-stream">{{controller.counts.Stream}}</a>
              </td>
              <td class="dash-app-resource">
                <a href="#/data" class="dash-app-resource-dataset">{{controller.counts.Dataset}}</a>
              </td>
              <td class="dash-app-resource">
                <a href="#/queries" class="dash-app-resource-query">{{controller.counts.Query}}</a>
              </td>
            </tr>
          </tbody>
        </table>
        <table class="table dash-app-trends">
          <tbody>
            <tr>
              <td style="width: 50%;">{{view C.Vw.Chart mode="dash" color="orange" metrics="processed.count"}}</td>
              <td style="width: 50%;">{{view C.Vw.Chart mode="dash" color="orange" unit="bytes" metrics="storage.trend"}}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="panel">
        <div class="panel-head">
          {{view C.Vw.CreateButton entityType="Application"}}
          <div class="panel-title">Applications</div>
        </div>
        {{view C.Vw.ApplicationList}}
      </div>
    </div>
  </script>

  <script type="text/x-handlebars" data-template-name="application">
    <div id="title">
      {{view C.Vw.TimeSelector}}
      <div id="start-all-button" class="pull-right" style="margin-top:2px;text-align:center;width:90px;">
        <button {{action startAll on="click"}} class="btn">Start All</button>
        <img style="display: none;margin-top: 2px;" src="/assets/img/start-all-load.gif" />
      </div>
      <h1>{{current.name}} <span>Application</span></h1>
    </div>

    <div id="info">
      <div class="info-box" style="float: right; border: 0;padding: 0px 14px 0px 0px;">
        <div id="action-buttons" class="btn-group pull-right">
            <button class="btn dropdown-toggle" data-toggle="dropdown">
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu">
            <li><a href="#" {{action "delete" on="click"}}>Delete This App</a></li>
            <li class="divider"></li>
            <li><a href="#" {{action "promote" on="click"}}>Push to Cloud</a></li>
          </ul>
        </div>
      </div>
      <div class="info-box" style="float: right;border: 0;padding-right: 0;">
        {{view C.Vw.DropZone}}
      </div>
      <div class="info-box health-box"></div>
      <div class="info-box sparkline-box">{{view C.Vw.Chart metrics="processed.count"}}</div>
      <div class="info-box sparkline-box">{{view C.Vw.Chart metrics="busyness" unit="percent"}}</div>
      <div class="info-box" style="padding: 0;text-align: center;">
        <div class="sparkline-box-title">Storage</div>
        <div class="sparkline-box-value" style="padding-left: 0;padding-top: 19px;width: 80px;">{{current.storageLabel}}<br /><span>{{current.storageUnits}}</span></div>
      </div>
    </div>

    <div id="panels">
      <div class="panel">
        <div class="panel-head"><div class="panel-title">Streams</div></div>
        {{view C.Vw.StreamList}}
      </div>
      <div class="panel">

        <div class="panel-head">
        
        <div class="panel-title">Flows</div></div>
        {{view C.Vw.FlowList}}
      </div>
      <div class="panel">
        <div class="panel-head"><div class="panel-title">Datasets</div></div>
        {{view C.Vw.DatasetList}}
      </div>
      <div class="panel">
        <div class="panel-head"><div class="panel-title">Queries</div></div>
        {{view C.Vw.QueryList}}
      </div>
    </div>
  </script>

  <script type="text/x-handlebars" data-template-name="stream">
    <div id="title">
      {{view C.Vw.TimeSelector}}
      <h1>{{current.name}} <span>Stream</span></h1>
    </div>
    <div id="info">
      <div class="info-box" style="float: right; border: 0;">
        <div id="action-buttons">
          <button class="btn dropdown-toggle" data-toggle="dropdown" style="padding-left:16px;">Actions 
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu">
            <li><a {{action "delete" on="click"}}>Delete This Stream</a></li>
          </ul>
        </div>
      </div>
      <div class="info-box health-box"></div>
      <div class="info-box sparkline-box">{{view C.Vw.Chart title="Events per Second" metrics="stream.enqueue.stream//demo/{id}.count"}}</div>
      <div class="info-box sparkline-box">{{view C.Vw.Chart title="Reads per Second (All)" metrics="q.ack.stream//demo/{id}.count"}}</div>
      <div class="info-box" style="padding: 0;text-align: center;">
        <div class="sparkline-box-title">Storage</div>
        <div class="sparkline-box-value" style="padding-left: 0;padding-top:19px;width: 80px;">{{current.storageLabel}}<br /><span>{{current.storageUnits}}</span></div>
      </div>
      <div class="info-box" style="padding: 0;text-align: center;">
        <div class="sparkline-box-title">Unconsumed</div>
        <div class="sparkline-box-value" style="padding-top:19px;padding-left:0;width:100px;">{{current.unconsumed}}<br /><span>Events</span></div>
      </div>
    </div>
    <div id="panels">
      <div class="panel">
      <div class="panel-head"><div class="panel-title">Attached Flows</div></div>
      
        {{#if controller.current.types.StreamFlow.content.length}}
          <table class="table">
          <thead>
            <th colspan="2">&nbsp;</th>
            <th style="width: 100px;text-align:center;">Unconsumed</th>
            <th style="width: 448px;">Reads per Second</th>
          </thead>
          {{#each controller.current.types.StreamFlow.content tagName="tbody"}}
          <tr>
            <td class="list-health-cell">
              <div class="list-health-box"></div>
            </td>
            <td class="app-list-name">
              <a {{bindAttr href="href"}}>{{name}}</a><br /><span class="app-list-status">{{app}}</span>
            </td>
            <td class="app-list-count">{{unconsumed}}<br /><span>Events</span></td>
            <td>{{view C.Vw.Chart entity-id=id entity-type="StreamFlow" metrics="stream.enqueue.{id}.count,q.ack.stream//demo/{id}.count"}}</td>
          </tr>
          {{/each}}
          </table>
        {{else}}
          <div class="object-list-empty">
            <div class="object-list-empty-content">
              No Attached Flows.
              <br /><span>Specify streams within your flow definition file.</span>
            </div>
          </div>
        {{/if}}
      </div>
    </div>
  </script>

  <script type="text/x-handlebars" data-template-name="flow">

    <div id="title">
      {{view C.Vw.TimeSelector}}
      <ul class="nav nav-pills pull-right" style="margin: 2px 14px;">
        <li class="active"><a href="#">Status</a></li>
        <li><a href="#" {{action "goToLog" on="click"}}>Logs</a></li>
        <li><a href="#" {{action "goToHistory" on="click"}}>History</a></li>
      </ul>
      <h1>{{current.meta.name}} <span>Flow</span></h1>
    </div>

    <div id="info">
      <div class="info-box" style="float: right; border: 0;padding-right: 14px;padding-left: 0px;">
        <div id="action-buttons" class="btn-group pull-right">
            <button class="btn dropdown-toggle" data-toggle="dropdown">
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu">
            <li style="min-width:200px; padding:4px 16px 2px;">
              {{#each current.getMeta}}
                <div><strong>{{k}}</strong>: {{v}}
              {{/each}}
            </li>
            <li class="divider"></li>
            <li><a {{action "delete" on="click"}}>Delete This Flow</a></li>
            {{#unless ENV.isCloud}}
              <li class="divider"></li>
              <li><a href="#" {{action "promote" on="click"}}>Push to Cloud</a></li>
            {{/unless}}
          </ul>

          {{#unless ENV.isCloud}}
          <button class="btn" style="width:64px;" {{action "promote" on="click"}} {{bindAttr flow-app="current.applicationId"}} {{bindAttr flow-id="current.meta.name"}} flow-action="Drain"><span class="btn-drain" />Push</button>
          {{/unless}}
          
          <button class="btn" {{bindAttr disabled="current.stopDisabled"}} style="width:64px;" {{action "exec" on="click"}} {{bindAttr flow-app="current.applicationId"}} {{bindAttr flow-id="current.meta.name"}} flow-action="Stop" ><span class="btn-stop" />Stop</button>
          
          <button class="btn" {{bindAttr disabled="current.startPauseDisabled"}} style="width:64px;" {{action "exec" on="click"}} {{bindAttr flow-app="current.applicationId"}} {{bindAttr flow-id="current.meta.name"}} {{bindAttr flow-action="current.defaultAction"}}><span {{bindAttr class="current.actionIcon"}} />{{current.defaultAction}}</button>

        </div>
        <div class="flow-state"><strong>{{current.currentState}}</strong></div>
      </div>
      <div class="info-box health-box"></div>
      <div class="info-box sparkline-box">{{view C.Vw.Chart metrics="processed.count"}}</div>
      <div class="info-box sparkline-box">{{view C.Vw.Chart metrics="busyness" unit="percent"}}</div>
    </div>

    <div id="panels">
      <div id="informer"></div>
      <div class="panel">
        <div id="flowviz-container">
          <div class="btn-group" style="float: left;">
            <button class="btn dropdown-toggle" data-toggle="dropdown" style="padding-left:14px;float: right;">
              {{view.flowletLabelName}} <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a {{action "setFlowletLabel" on="click"}}>Enqueue Rate</a></li>
              <li><a {{action "setFlowletLabel" on="click"}}>Queue Size</a></li>
              <li><a {{action "setFlowletLabel" on="click"}}>Total Processed</a></li>
            </ul>
          </div>
          {{view C.Vw.Visualizer viewName="visualizer"}}
        </div>
      </div>
    </div>

    {{view C.Vw.StreamDetail viewName="stream-detail"}}
    {{view C.Vw.FlowletDetail viewName="flowlet-detail"}}

  </script>

  <script type="text/x-handlebars" data-template-name="flow-log">

    <div id="title">
      {{view C.Vw.TimeSelector}}
      <ul class="nav nav-pills pull-right" style="margin: 2px 14px;">
        <li><a href="#" {{action "goToStatus" on="click"}}>Status</a></li>
        <li class="active"><a href="#">Logs</a></li>
        <li><a href="#" {{action "goToHistory" on="click"}}>History</a></li>
      </ul>
      <h1>{{current.meta.name}} <span>Flow</span></h1>
    </div>

    <div id="panels">
      <div class="panel" style="padding: 10px;">
        <pre id="logView" class="well query-response"></pre>
      </div>
    </div>

  </script>

  <script type="text/x-handlebars" data-template-name="query-log">

    <div id="title">
      {{view C.Vw.TimeSelector}}
      <ul class="nav nav-pills pull-right" style="margin: 2px 14px;">
        <li><a href="#" {{action "goToStatus" on="click"}}>Status</a></li>
        <li class="active"><a href="#">Logs</a></li>
      </ul>
      <h1>{{current.name}} <span>Query</span></h1>
    </div>

    <div id="panels">
      <div class="panel" style="padding: 10px;">
        <pre id="logView" class="well query-response"></pre>
      </div>
    </div>

  </script>

  <script type="text/x-handlebars" data-template-name="flow-history">
    <div id="title">
      {{view C.Vw.TimeSelector}}
       <ul class="nav nav-pills pull-right" style="margin: 2px 14px;">
        <li><a href="#" {{action "goToStatus" on="click"}}>Status</a></li>
        <li><a href="#" {{action "goToLog" on="click"}}>Logs</a></li>
        <li class="active"><a href="#">History</a></li>
      </ul>
      <h1>{{current.meta.name}} <span>Flow</span></h1>
    </div>

    <div id="panels">
      <div id="informer"></div>
      <div class="panel">
        <div id="flowviz-container" class="flowviz-fade">
          {{view C.Vw.Visualizer viewName="visualizer"}}
        </div>
      </div>
      <div class="panel">
      <div id="object-list">
        {{#if content.length}}
          <table class="table table-condensed">
          <thead>
            <tr><th style="width: 215px;">Started</th>
            <th>Ended</th>
            <th style="width:250px;">Result</th>
            </tr>
          </thead>
          {{#each content tagName="tbody"}}
            <tr class="run-list" {{action "loadRun" on="click"}} {{bindAttr id="runId"}}>
              <td>{{started}}</td>
              <td>{{ended}}</td>
              <td>{{detail}}</td>
            </tr>
          {{/each}}
          </table>
        {{else}}
          <div class="object-list-empty">
            This flow has not completed a run yet.
          </div>
        {{/if}}
        </div></div></div>
    </div>
    <div id="flowlet-container">
      <div id="flowlet-popup">
        {{view C.Vw.FlowletDetail viewName="flowlet-detail"}}
      </div>
    </div>
  </script>

  <script type="text/x-handlebars" data-template-name="dataset">
    <div id="title">
      {{view C.Vw.TimeSelector}}
      <h1>{{current.name}} <span>{{current.typeName}}</span></h1>
    </div>
    <div id="info">
      <div class="info-box" style="float: right; border: 0;">
        <div id="action-buttons">
            <button class="btn dropdown-toggle" data-toggle="dropdown" style="padding-left:16px;">Actions 
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu">
            <li><a {{action "delete" on="click"}}>Delete This Dataset</a></li>
          </ul>
        </div>
      </div>
      <div class="info-box health-box"></div>
      <div class="info-box sparkline-box">{{view C.Vw.Chart title="Writes per Second" metrics="dataset.write.{id}.count"}}</div>
      <div class="info-box sparkline-box">{{view C.Vw.Chart title="Reads per Second (All)" metrics="dataset.read.{id}.count"}}</div>
       <div class="info-box" style="padding: 0;text-align: center;">
        <div class="sparkline-box-title">Storage</div>
        <div class="sparkline-box-value" style="padding-left: 0;padding-top:19px;width: 80px;">{{current.storageLabel}}<br /><span>{{current.storageUnits}}</span></div>
      </div>
    </div>
    <div id="panels">

      <div class="panel">
      <div class="panel-head"><div class="panel-title">Attached Flows</div></div>
      
        {{#if controller.types.DatasetFlow.content.length}}
          <table class="table">
          <thead>
            <th colspan="2">&nbsp;</th>
            <th style="width: 262px;">Writes per Second</th>
            <th style="width: 262px;">Reads per Second</th>
          </thead>
          {{#each controller.types.DatasetFlow.content tagName="tbody"}}
          <tr>
            <td class="list-health-cell">
              <div class="list-health-box"></div>
            </td>
            <td class="app-list-name">
              <a {{bindAttr href="href"}}>{{name}}</a><br /><span class="app-list-status">{{typeName}}</span>
            </td>
            <td>{{view C.Vw.Chart entity-id=id entity-type="DatasetFlow" mode="singular" metrics="dataset.write.{id}.count"}}</td>
            <td>{{view C.Vw.Chart entity-id=id entity-type="DatasetFlow" mode="singular" metrics="dataset.read.{id}.count"}}</td>
          </tr>
          {{/each}}
          </table>
        {{else}}
          <div class="object-list-empty">
            <div class="object-list-empty-content">
              No Attached Flows.
              <br /><span>Specify streams within your flow definition file.</span>
            </div>
          </div>
        {{/if}}
      </div>
  </script>


  <script type="text/x-handlebars" data-template-name="query">
    <div id="title">
      {{view C.Vw.TimeSelector}}
       <ul class="nav nav-pills pull-right" style="margin: 2px 14px;">
        <li class="active"><a href="#">Status</a></li>
        <li><a href="#" {{action "goToLog" on="click"}}>Logs</a></li>
      </ul>
      <h1>{{current.name}} <span>Query</span></h1>
    </div>
    <div id="info">
      <div class="info-box" style="float: right; border: 0;">
      <div id="action-buttons" class="btn-group" style="float: right;">



        <button class="btn" {{bindAttr disabled="current.startPauseDisabled"}} style="width:64px;" {{action "exec" on="click"}} {{bindAttr flow-app="current.applicationId"}} {{bindAttr flow-id="current.id"}} {{bindAttr flow-action="current.defaultAction"}}><span {{bindAttr class="current.actionIcon"}} />{{current.defaultAction}}</button>

          {{#unless ENV.isCloud}}
          <button class="btn" style="width:64px;" {{action "promote" on="click"}} {{bindAttr flow-app="current.applicationId"}} {{bindAttr flow-id="current.id"}} flow-action="Drain"><span class="btn-drain" />Push</button>
          {{/unless}}

        <button class="btn dropdown-toggle" data-toggle="dropdown">
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
          <li><a {{action "delete" on="click"}} {{bindAttr state="current.currentState"}} {{bindAttr flowId="current.id"}} {{bindAttr applicationId="current.application"}}>Delete This Query</a></li>
          {{#unless ENV.isCloud}}
            <li class="divider"></li>
            <li><a href="#" {{action "promote" on="click"}} {{bindAttr flowId="current.id"}} {{bindAttr applicationId="current.application"}}>Push to Cloud</a></li>
          {{/unless}}
        </ul>
        </div>
        <div class="flow-state"><strong>{{current.currentState}}</strong></div>

      </div>
      <div class="info-box health-box"></div>
      <div class="info-box sparkline-box">{{view C.Vw.Chart title="Successful Requests" metrics="query.success.count"}}</div>
      <div class="info-box sparkline-box">{{view C.Vw.Chart title="Failed Requests" metrics="query.failure.count"}}</div>
    </div>
    <div id="panels">

      <div class="panel">
      <div class="panel-head"><div class="panel-title">Make a Request</div></div>
        <table style="width: 100%">
          <thead>
          <tr>
            <th style="width: 140px;text-align: left;">
              Method
            </th>
            <th style="text-align: left;">
              Parameters
            </th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>
              {{view C.Vw.TextField valueBinding="view.requestMethod" }}
            </td>
            <td>
              {{view Ember.TextField valueBinding="view.requestParams" width="100%"}}
              <button {{action "submit" on="click"}} class="btn btn-success" style="margin:0px 16px;">Execute</button>
            </td>
          </tr>
          </tbody>
        </table>
      </div>

      <div class="panel" style="padding: 10px;">
        {{view Ember.TextArea valueBinding="view.responseBody" classNames="well query-response"}}
      </div>
  </script>

</body>
</html>
