apply plugin: 'continuuity'

buildscript {
  apply from: 'continuuity.gradle'
}

/**
 * Specify all the dependencies
 */
dependencies {
    compile group: 'com.continuuity', name: 'common', version: '0.1.0-SNAPSHOT'
    compile group: 'org.apache.thrift', name: 'libthrift', version: '0.8.0'
    compile group: 'com.google.guava', name: 'guava', version: '11.+'
    compile group: 'com.google.inject', name: 'guice', version: '3.0-rc3'
    compile group: 'org.apache.commons', name: 'commons-math', version: '2.+'
    compile group: 'com.google.code.gson', name: 'gson', version: '2.1'
    compile group: 'com.netflix.curator', name: 'curator-recipes', version: '1.1.10'
    compile group: 'hsqldb', name: 'hsqldb', version: '1.8.0.10'
    compile group: 'com.yammer.metrics', name: 'metrics-core', version: '2.1.+'
    testCompile group: 'junit', name: 'junit', version: '4.+'
    testCompile group: 'org.mockito', name: 'mockito-core', version: '1.9.+'
}

/**
 * Generate thrift files.
 */
/*
task thrift
thrift {
    group = 'Continuuity'
    description = 'Generates thrift stubs'
    files = fileTree(dir: 'src/main/thrift').matching{ include '*.thrift'}
    doFirst {
      println 'Generating thrift stubs ...'
    }
    exec {
        executable = 'thrift'
        args = [ '--gen', 'java:beans, hashcode', '-out', 'src/main/java', files.collect { relativePath(it)}. join(",")]
    }
    doLast {
      println 'Thrift stubs generation done ...'
    }
}
*/

/**
 * Create Release TAR ball
 */
task dist(type:  Tar, dependsOn: jar) {
    group = 'Continuuity'
    description = 'Generates distribution tar file.'
    from('bin') {
     into('flow/bin')
    }

    into('flow/conf') {
     from sourceSets.main.output.resourcesDir
    }

    into('flow/libs') {
      from configurations.compile
      from jar.outputs.files
    }
}
