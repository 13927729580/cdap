// Configures clover for monitoring code coverage.

/// Define common configuration for all projects including the root project.
allprojects
{
    apply plugin: 'clover'

    dependencies {
        clover 'com.cenqua.clover:clover:3.1.3'
    }

    clover
    {
        licenseLocation = 'classpath://com/continuuity/gradle/clover.license'
        // Exclude all generated classes from the test report.
        excludes = ['**/generated/*.java']
        // This makes sure the gradle clover plugin doesn't set the default includeTest path to '**/*Test.java'.
        testIncludes = ['**/*.java']
		// Add API source directories for top-level and individual projects
		println "Clover: Project is: " + project + " , parent is " + project.parent
		if (project.hasProperty('multiModule') && project.parent == null) {
			println "This is a multi module top level project"
			additionalSourceDirs = subprojects.collect { project ->
				project.sourceSets.api.allSource.srcDirs}
		} else {
			println "Non multi module or not main project"
			additionalSourceDirs = sourceSets.api.allSource.srcDirs
		}
        //targetPercentage = '85%'
        report {
            html = true
        }
    }

    task clover (dependsOn: cloverGenerateReport) {
        group = 'Report'
        description = 'Short cut for the cloverGenerateReport task.'
    }



}
