apply plugin: 'idea'
apply plugin: 'maven'

version = '0.1.0-SNAPSHOT'
ext.groupId = 'com.continuuity'
ext.artifactId = projectDir.name;

defaultTasks 'build'

void setDefault (String name, Object value)
{
    if(!project.hasProperty (name))
    {
        project.ext.set(name, value);
    }
}

setDefault('artifactoryUsername', 'gradle');
setDefault('artifactoryPassword', '{DESede}Rk/0rTcxzWomG91yhihmswrLqVnA6oIy');

/// Define artifact repositories.
repositories {
    maven {
        credentials {
            username artifactoryUsername
            password artifactoryPassword
        }
        url "https://repository.continuuity.com/continuuity-gradle-local/"
    }
    maven {
        credentials {
            username artifactoryUsername
            password artifactoryPassword
        }
        url "https://repository.continuuity.com/libs-snapshot"
    }
    maven {
        credentials {
            username artifactoryUsername
            password artifactoryPassword
        }
        url "https://repository.continuuity.com/libs-release"
    }
}

configurations.all {
    resolutionStrategy.cacheChangingModulesFor 0, 'minutes'
}

uploadArchives {
    repositories {
        repositories.mavenDeployer {
            repository(url: "https://repository.continuuity.com/continuuity-gradle-local") {
                authentication(userName: artifactoryUsername, password: artifactoryPassword)
            }
            pom.version = version
            pom.artifactId = artifactId
            pom.groupId = groupId
        }
    }
}